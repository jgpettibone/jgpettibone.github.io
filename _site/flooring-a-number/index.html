<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Flooring a Number &#8211; Hacking Away</title>
<meta name="description" content="">
<meta name="keywords" content="bitwise operators, floor, math">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="/images/numbers.jpg">

<meta name="twitter:title" content="Flooring a Number">
<meta name="twitter:description" content="">
<meta name="twitter:creator" content="@jgpettibone">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Flooring a Number">
<meta property="og:description" content="">
<meta property="og:url" content="/flooring-a-number/">
<meta property="og:site_name" content="Hacking Away">





<link rel="canonical" href="/flooring-a-number/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Hacking Away Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.min.css">
<!-- Webfonts -->
<link href="http://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">




<style type="text/css">body {background-image:url(/images/witewall_3.png);}</style>


</head>

<body id="post" class="feature">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="">Home</a></li>
		<li>
			<a href="#">About</a>
			<ul class="dl-submenu">
				<li>
					<img src="/images/mylinkedinphoto.jpg" alt="Jeanette Pettibone photo" class="author-photo">
					<h4>Jeanette Pettibone</h4>
					<p>Full Stack Software Engineer. Linguist. Computer and Natural Language Processor.</p>
				</li>
				<li><a href="/about/">Learn More</a></li>
				
				
				
				<li>
					<a href="http://github.com/jgpettibone"><i class="icon-github"></i> GitHub</a>
				</li>
				<li>
					<a href="http://linkedin.com/in/jeanettepettibone"><i class="icon-linkedin"></i> LinkedIn</a>
				</li>
				<li>
					<a href="http://twitter.com/jgpettibone"><i class="icon-twitter"></i> Twitter</a>
				</li>
				
				
				
				
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">Posts</a>
			<ul class="dl-submenu">
				<li><a href="/posts/">All Posts</a></li>
				<li><a href="/tags/">All Tags</a></li>
			</ul>
		</li>
		
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->



<div class="entry-header">
  
  <div class="entry-image">
    <img src="/images/numbers.jpg" alt="Flooring a Number">
  </div><!-- /.entry-image -->
</div><!-- /.entry-header -->


<div id="main" role="main">
  <article class="hentry">
    <header class="header-title">
      <div class="header-title-wrap">
        
          <h1 class="entry-title"><a href="/flooring-a-number/" rel="bookmark" title="Flooring a Number">Flooring a Number</a></h1>
        
        <h2>May 06, 2014</h2>
      </div><!-- /.header-title-wrap -->
    </header>
    <div class="entry-content">
      <h2 id="flooring-a-number-with-bitwise-or">Flooring a Number with Bitwise OR</h2>
<p>Somewhere along the way, I stopped using JavaScript’s Math.floor() function and I started using bitwise OR 0 such as in the following example:</p>

<div class="highlight"><pre><code class="javascript"><span class="mf">2.145</span> <span class="o">|</span> <span class="mi">0</span>  <span class="c1">// 2</span>
</code></pre></div>

<p>In fact, there are other ways of flooring a number by using bitwise operators.  Some of the best known are:</p>

<ul>
  <li>left shift («)</li>
</ul>

<div class="highlight"><pre><code class="javascript"><span class="mf">2.145</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span>  <span class="c1">// 2</span>
</code></pre></div>

<ul>
  <li>double NOT (~~)</li>
</ul>

<div class="highlight"><pre><code class="javascript"><span class="o">~~</span><span class="mf">2.145</span>  <span class="c1">// 2</span>
</code></pre></div>

<p>There are many posts out there about the relative speed of these different methods, most of which insist that Math.floor() is slower than bitwise operators.  There are a few JS Perfs out there on just this topic - <a href="http://jsperf.com/jsfvsbitnot/8">bitwise NOT vs Math.floor()</a> and <a href="http://jsperf.com/or-vs-floor/2">or-vs-floor</a> are two of these.</p>

<p>But I continued to use bitwise OR 0 without really researching exactly how it worked and whether it was really better than Math.floor().  Until today.</p>

<h2 id="what-happened">What Happened?</h2>
<p>I wrote a simple function that extended the Number prototype with a new method called <code>toEnglish</code> that returns the number as a string using English words.  For example:</p>

<div class="highlight"><pre><code class="bash">&gt; <span class="o">(</span>123456789<span class="o">)</span>.toEnglish<span class="o">()</span>
  <span class="s2">&quot;one hundred twenty-three million four hundred fifty-six thousand seven hundred eighty-nine&quot;</span>
&gt; <span class="o">(</span>1000000000000<span class="o">)</span>.toEnglish<span class="o">()</span>
  <span class="s2">&quot;one trillion&quot;</span>
</code></pre></div>

<p>But something happened when I tried to call this method on numbers greater than one trillion!  For the number 10,000,000,000,000, instead of getting the result “ten trillion” I got something very strange.</p>

<div class="highlight"><pre><code class="bash">&gt; <span class="o">(</span>10000000000000<span class="o">)</span>.toEnglish<span class="o">()</span>
  <span class="s2">&quot;one trillion four hundred ten billion sixty-five million four hundred eight thousand&quot;</span>
</code></pre></div>

<p>What?</p>

<h2 id="the-limitation-of-bitwise-operators">The Limitation of Bitwise Operators</h2>
<p>I had run into the limitation of using bitwise OR.  Bitwise operators treat their operands as a sequence of 32 binary bits (zeros and ones) and will actually truncate larger numbers down to 32 bits.  So you really should only use bitwise operators when you know you’ll be working with 32 bit numbers.  The JavaScript Number Type, however, represents the double-precision 64-bit format IEEE 754 values (for more information, see the <a href="http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdf">ECMAScript Language Specification</a>).  </p>

<p>In the example above, my <code>toEnglish</code> function had a line of code using the bitwise OR 0 - <code>num = num / 1000 | 0</code> - which was dividing the num 10000000000000 by 1000 and setting num to 10000000000, which is 34 bits, before using the bitwise OR.  </p>

<div class="highlight"><pre><code class="bash">&gt; <span class="o">(</span>10000000000<span class="o">)</span>.toString<span class="o">(</span>2<span class="o">)</span>
  <span class="s2">&quot;1001010100000010111110010000000000&quot;</span>
</code></pre></div>

<p>Note that to quickly see the binary (base 2) number from any decimal (base 10) number, you can call the <code>toString()</code> function with a specified base as the argument.  In the example, I called <code>toString(2)</code> to see the base 2 (binary) number.</p>

<h2 id="but-how-do-bitwise-operators-work">But How Do Bitwise Operators Work?</h2>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Bitwise_Operators">Bitwise operators</a> work as follows (from MDN):</p>

<ul>
  <li>The operands are converted into 32 bit integers and expressed as zeros and ones</li>
  <li>Each bit in the first operand is paired with the corresponding bit in the second operand: first bit to first bit, second bit to second bit, etc.</li>
  <li>The operator is applied to each pair of bits, and the result is constructed bitwise.</li>
</ul>

<p>Below are some bitwise operators.</p>

<h3 id="bitwise-and-">Bitwise AND (&amp;)</h3>

<table rules="groups">
  <thead>
    <tr>
      <th style="text-align: left">BASE 10</th>
      <th style="text-align: center">BASE 2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">9</td>
      <td style="text-align: center">00000000000000000000000000001001</td>
    </tr>
    <tr>
      <td style="text-align: left">14</td>
      <td style="text-align: center">00000000000000000000000000001110</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td style="text-align: left">14&amp;9</td>
      <td style="text-align: center">00000000000000000000000000001000</td>
    </tr>
  </tbody>
</table>

<h3 id="bitwise-or-">Bitwise OR (|)</h3>

<table rules="groups">
  <thead>
    <tr>
      <th style="text-align: left">BASE 10</th>
      <th style="text-align: center">BASE 2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">9</td>
      <td style="text-align: center">00000000000000000000000000001001</td>
    </tr>
    <tr>
      <td style="text-align: left">14</td>
      <td style="text-align: center">00000000000000000000000000001110</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td style="text-align: left">14|9</td>
      <td style="text-align: center">00000000000000000000000000001111</td>
    </tr>
  </tbody>
</table>

<h3 id="bitwise-xor-">Bitwise XOR (^)</h3>

<table rules="groups">
  <thead>
    <tr>
      <th style="text-align: left">BASE 10</th>
      <th style="text-align: center">BASE 2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">9</td>
      <td style="text-align: center">00000000000000000000000000001001</td>
    </tr>
    <tr>
      <td style="text-align: left">14</td>
      <td style="text-align: center">00000000000000000000000000001110</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td style="text-align: left">14^9</td>
      <td style="text-align: center">00000000000000000000000000000111</td>
    </tr>
  </tbody>
</table>

<h3 id="bitwise-not-">Bitwise NOT (~)</h3>

<table rules="groups">
  <thead>
    <tr>
      <th style="text-align: left">BASE 10</th>
      <th style="text-align: center">BASE 2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">9</td>
      <td style="text-align: center">00000000000000000000000000001001</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td style="text-align: left">~9</td>
      <td style="text-align: center">11111111111111111111111111110110</td>
    </tr>
  </tbody>
</table>

<h3 id="bitwise-left-shift-">Bitwise Left Shift («)</h3>

<table rules="groups">
  <thead>
    <tr>
      <th style="text-align: left">BASE 10</th>
      <th style="text-align: center">BASE 2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">9</td>
      <td style="text-align: center">00000000000000000000000000001001</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td style="text-align: left">9«2</td>
      <td style="text-align: center">00000000000000000000000000100100</td>
    </tr>
  </tbody>
</table>

<h3 id="bitwise-sign-propogating-right-shift-">Bitwise (Sign-Propogating) Right Shift (»)</h3>

<table rules="groups">
  <thead>
    <tr>
      <th style="text-align: left">BASE 10</th>
      <th style="text-align: center">BASE 2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">9</td>
      <td style="text-align: center">00000000000000000000000000001001</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td style="text-align: left">9»2</td>
      <td style="text-align: center">00000000000000000000000000000010</td>
    </tr>
  </tbody>
</table>

<h2 id="how-do-bitwise-operators-floor-numbers">How Do Bitwise Operators Floor Numbers?</h2>
<p>Bitwise operators floor numbers simply because they convert their operands into 32 bit integers.  This conversion to integer, however, is done by truncation and not by rounding the number.  This means that for negative numbers, the results of using Math.floor() won’t be the same as the results of using a bitwise operator.  Take a look at the following:</p>

<div class="highlight"><pre><code class="bash">&gt; Math.floor<span class="o">(</span>2.134<span class="o">)</span>
  2
&gt; 2.134 <span class="p">|</span> 0
  2
&gt; Math.floor<span class="o">(</span>-2.134<span class="o">)</span>
  -3
&gt; -2.134 <span class="p">|</span> 0
  -2
</code></pre></div>

<p>There’s also a difference with NaN:</p>

<div class="highlight"><pre><code class="bash">&gt; Math.floor<span class="o">(</span>NaN<span class="o">)</span>
  NaN
&gt; NaN <span class="p">|</span> 0
  0
</code></pre></div>

<h2 id="bottom-line">Bottom Line</h2>
<p>Using these bitwise operators isn’t the equivalent to using Math.floor(), though for positive numbers that have fewer than 32 bits the results will be the same.  To be on the safe side, however, it’s a good idea to know what your data is and to be consistent.</p>

      <footer class="entry-meta">
        <span class="entry-tags"><a href="/tags/#bitwise operators" title="Pages tagged bitwise operators" class="tag">bitwise operators</a><a href="/tags/#floor" title="Pages tagged floor" class="tag">floor</a><a href="/tags/#math" title="Pages tagged math" class="tag">math</a></span>
        <span><a href="/flooring-a-number/" rel="bookmark" title="Flooring a Number">Flooring a Number</a> was published on <span class="entry-date date published updated"><time datetime="2014-05-06T00:00:00-07:00">May 06, 2014</time></span></span>
        (revised: <span class="entry-date date modified"><time datetime="2014-05-06">05/06/2014</time></span>)
        <span class="author vcard"><span class="fn"><a href="/about/" title="About Jeanette Pettibone">Jeanette Pettibone</a></span></span>
        <div class="social-share">
          <ul class="socialcount socialcount-small inline-list">
            <li class="facebook"><a href="https://www.facebook.com/sharer/sharer.php?u=/flooring-a-number/" title="Share on Facebook"><span class="count"><i class="icon-facebook-sign"></i> Like</span></a></li>
            <li class="twitter"><a href="https://twitter.com/intent/tweet?text=/flooring-a-number/" title="Share on Twitter"><span class="count"><i class="icon-twitter-sign"></i> Tweet</span></a></li>
            <li class="googleplus"><a href="https://plus.google.com/share?url=/flooring-a-number/" title="Share on Google Plus"><span class="count"><i class="icon-google-plus-sign"></i> +1</span></a></li>
          </ul>
        </div><!-- /.social-share -->
      </footer>
    </div><!-- /.entry-content -->
    
    
    <div class="read-more">
      
        <div class="read-more-header">
          <a href="/prime-sieves/" class="read-more-btn">Read More</a>
        </div><!-- /.read-more-header -->
        <div class="read-more-content">
          <h3><a href="/make-a-thing/" title="Freaq Out!">Freaq Out!</a></h3>
          <p>## The `freaq` bookmarkletOne of my students, Zach Pomerantz, created a bookmarklet called [freaq](http://www.freaq.io/) that is an audio...&hellip; <a href="/make-a-thing/">Continue reading</a></p>
        </div><!-- /.read-more-content -->
      
      <div class="read-more-list">
        
          <div class="list-item">
            <h4><a href="/bitwise-n-queens/" title="Bitwise N-Queens">Bitwise N-Queens</a></h4>
            <span>Published on May 08, 2014</span>
          </div><!-- /.list-item -->
        
          <div class="list-item">
            <h4><a href="/prime-sieves/" title="Prime Sieves">Prime Sieves</a></h4>
            <span>Published on April 26, 2014</span>
          </div><!-- /.list-item -->
        
      </div><!-- /.read-more-list -->
      
    </div><!-- /.read-more -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2020 Jeanette Pettibone. Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="http://mademistakes.com/hpstr/">HPSTR Theme</a>.</span><br><span>         <a href="http://github.com/jgpettibone"><i class="icon-github"></i>  </a>  <a href="http://linkedin.com/in/jeanettepettibone"><i class="icon-linkedin"></i>  </a> <a href="http://twitter.com/jgpettibone"><i class="icon-twitter"></i>  </span>

  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>

<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = ''; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>	        

</body>
</html>
